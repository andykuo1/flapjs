!function(t){var e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);var i=class{constructor(){this.eventMap=new Map}addListener(t,e){this.eventMap.has(t)||this.eventMap.set(t,[]),this.eventMap.get(t).push(e)}removeListener(t,e){if(!this.eventMap.has(t))return;const s=this.eventMap.get(t);s.splice(s.indexOf(e),1)}clearListeners(t){this.eventMap.has(t)&&(this.eventMap.get(t).length=0)}countListeners(t){return this.eventMap.has(t)?this.eventMap.get(t).length:0}getListeners(t){return this.eventMap.get(t)}emit(t){if(!this.eventMap.has(t))return;const e=Array.prototype.splice.call(arguments,1),s=this.eventMap.get(t),i=s.length;let n=0;for(;n<i;)s[n].apply(null,e)?(s.splice(n,1),--n):++n;this.onEventProcessed(t,e)}on(t,e){this.addListener(t,e)}once(t,e){this.addListener(t,()=>(e(),!0))}onEventProcessed(t,e){}};class n{constructor(t,e){this.x=0,this.y=0,this.scrollX=0,this.scrollY=0,this.events=new i,this._canvas=t,this._element=e,this._mouseup=this.onMouseUp.bind(this),this._mousedown=this.onMouseDown.bind(this),this._mouseclick=this.onMouseClick.bind(this),this._mousemove=this.onMouseMove.bind(this),this._wheel=this.onMouseWheel.bind(this),this._touchstart=this.onTouchStart.bind(this),this._touchmove=this.onTouchMove.bind(this),this._touchstop=this.onTouchStop.bind(this),this._contextmenu=(t=>(t.preventDefault(),!1)),this._element.addEventListener("contextmenu",this._contextmenu,!1),this._element.addEventListener("mouseup",this._mouseup),this._element.addEventListener("mousedown",this._mousedown),this._element.addEventListener("click",this._mouseclick),this._element.addEventListener("mousemove",this._mousemove),this._element.addEventListener("wheel",this._wheel),this._element.addEventListener("touchstart",this._touchstart)}destroy(){this._element.removeEventListener("contextmenu",this._contextmenu),this._element.removeEventListener("mouseup",this._mouseup),this._element.removeEventListener("mousedown",this._mousedown),this._element.removeEventListener("click",this._mouseclick),this._element.removeEventListener("mousemove",this._mousemove),this._element.removeEventListener("wheel",this._wheel),this._element.removeEventListener("touchstart",this._touchstart)}onMouseUp(t){this.onMouseMove(t),this.events.emit("mouseup",this,t.which)}onMouseDown(t){this.onMouseMove(t),this.events.emit("mousedown",this,t.which)}onMouseClick(t){this.onMouseMove(t),this.events.emit("mouseclick",this,t.which)}onMouseWheel(t){this.scrollX+=t.deltaX,this.scrollY+=t.deltaY,this.events.emit("wheel",this,t.deltaX,t.deltaY)}onMouseMove(t){const e=this._canvas.getBoundingClientRect();this.x=t.clientX-e.left,this.y=t.clientY-e.top}onTouchStart(t){const e=t.touches[0].target;e.addEventListener("touchmove",this._touchmove),e.addEventListener("touchend",this._touchstop),e.addEventListener("touchcancel",this._touchstop)}onTouchStop(t){const e=t.touches[0].target;e.removeEventListener("touchmove",this._touchmove),e.removeEventListener("touchend",this._touchstop),e.removeEventListener("touchcancel",this._touchstop)}onTouchMove(t){this.onMouseMove(t.touches[0])}}n.BUTTON_LEFT=1,n.BUTTON_RIGHT=3;var o=n;const h=16,r=256,a=2*Math.PI,c=[6,4],l=1e3;var u=class{constructor(t,e,s){this.canvas=t,this.mouse=e,this.graph=s,this.targetSource=null,this.targetDestination=null,this.moveTarget=null}load(){this.mouse.events.on("mousedown",(t,e)=>{3==e?this.startMove(t.x,t.y):this.markTarget(t.x,t.y)}),this.mouse.events.on("mouseup",(t,e)=>{3==e?this.endMove(t.x,t.y):this.releaseTarget(t.x,t.y)}),document.getElementById("newstate").addEventListener("click",t=>{this.createNewState()})}draw(t,e){if(null!==this.targetSource){const t=this.getStateByPosition(this.mouse.x,this.mouse.y);this.isSelfMode&&t!==this.targetSource&&(this.isSelfMode=!1),this.isSelfMode||(this.targetDestination=t)}if(null!==this.moveTarget){t.strokeStyle="black";const s=e/l%a;t.save(),t.beginPath(),t.setLineDash(c),t.arc(this.mouse.x,this.mouse.y,h,0+s,a+s),t.stroke(),t.restore()}}createNewState(){const t=Math.random()*this.canvas.width,e=Math.random()*this.canvas.height,s=this.graph.createNewNode();return s.x=t,s.y=e,s.accept=!1,s}createNewTransition(t,e){const s=this.graph.createNewEdge(t,e);return s.label="0",s}markTarget(t,e){this.targetSource=this.getStateByPosition(t,e),this.isSelfMode=!0}releaseTarget(t,e){if(null===this.targetSource)return;const s=this.getStateByPosition(t,e);this.isSelfMode||null===this.targetDestination?s===this.targetSource&&this.graph.toggleAcceptState(s):this.createNewTransition(this.targetSource,this.targetDestination),this.targetSource=null,this.targetDestination=null}startMove(t,e){this.moveTarget=this.getStateByPosition(t,e)}endMove(t,e){null!==this.moveTarget&&(this.moveTarget.x=t,this.moveTarget.y=e),this.moveTarget=null}getStateByPosition(t,e){for(const s of this.graph.nodes){const i=t-s.x,n=e-s.y;if(i*i+n*n<r)return s}return null}};const d=16,m=12,v=2*Math.PI;class g{constructor(t=0,e=0,s="q"){this.label=s,this.x=t,this.y=e,this.accept=!1}draw(t){t.font="12px Arial",t.textAlign="center",t.fillStyle="yellow",t.beginPath(),t.arc(this.x,this.y,d,0,v),t.fill(),t.stroke(),this.accept&&(t.beginPath(),t.arc(this.x,this.y,m,0,v),t.stroke()),t.fillStyle="black",t.fillText(this.label,this.x,this.y+4)}}class p{constructor(t,e,s="#"){this.label=s,this.from=t,this.to=e,this.quad=null}draw(t){t.font="12px Arial",t.textAlign="center",t.fillStyle="black";const e=Math.PI/6,s=this.from.x,i=this.from.y,n=this.to.x,o=this.to.y;let h=0;if(t.beginPath(),t.moveTo(s,i),null==this.quad)h=Math.atan2(s-n,i-o)+Math.PI,t.lineTo(n,o);else{const e=this.quad.x,s=this.quad.y;h=Math.atan2(e-n,s-o)+Math.PI,t.quadraticCurveTo(e,s,n,o)}t.moveTo(n-8*Math.sin(h-e),o-8*Math.cos(h-e)),t.lineTo(n,o),t.lineTo(n-8*Math.sin(h+e),o-8*Math.cos(h+e)),t.stroke(),t.closePath(),t.fillStyle="black",t.fillText(this.label,this.x,this.y)}}const w=document.getElementById("content"),M=w.getContext("2d"),f=new o(w,document);function _(t){w.width=window.innerWidth,w.height=window.innerHeight}window.addEventListener("load",_),window.addEventListener("resize",_),window.onload=function(){x.load()},window.requestAnimationFrame(function t(e){M.clearRect(0,0,w.width,w.height);!function(t,e){y.draw(t),x.draw(t,e)}(M,e);window.requestAnimationFrame(t)});const y=new class{constructor(){this.nodes=[],this.edges=[]}createNewNode(){const t=new g;return this.nodes.push(t),t}createNewEdge(t,e){const s=new p(t,e);return this.edges.push(s),s}draw(t){if(this.nodes.length>0){const e=this.nodes[0],s=e.x,i=e.y;t.beginPath(),t.moveTo(s-d,i),t.lineTo(s-2*d,i-d),t.lineTo(s-2*d,i+d),t.closePath(),t.stroke()}for(let e of this.nodes)e.draw(t);for(let e of this.edges)e.draw(t)}setInitialState(t){this.nodes.length<=1||(this.nodes.splice(this.nodes.indexOf(t),1),this.nodes.unshift(t))}toggleAcceptState(t){t.accept=!t.accept}getInitialState(){return this.nodes.length>0?this.nodes[0]:null}},x=new u(w,f,y)}]);